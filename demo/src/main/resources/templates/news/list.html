<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title th:text="'Latest News - NewsPlatform'">Latest News - NewsPlatform</title>
    <meta name="description" content="Stay updated with the latest news and breaking stories from around the world.">
</head>
<body>
    <div layout:fragment="content">
        <!-- Page Header -->
        <div class="page-header py-5 bg-light">
            <div class="container text-center">
                <h1 class="display-5 fw-bold">Latest News</h1>
                <p class="lead">Stay informed with the most recent updates and breaking stories</p>
            </div>
        </div>

        <div class="container py-4">
            <div class="row">
                <!-- Main Content -->
                <div class="col-lg-8">
                    <!-- Latest News Section -->
                    <div class="mb-5">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="h4 mb-0">Latest Updates</h2>
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="sortDropdown" data-bs-toggle="dropdown">
                                    Sort by: <span th:text="${sort == 'newest' ? 'Newest' : (sort == 'popular' ? 'Most Popular' : 'Trending')}">Newest</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" th:classappend="${sort == 'newest'} ? 'active'" 
                                          th:href="@{/news?sort=newest}">Newest</a></li>
                                    <li><a class="dropdown-item" th:classappend="${sort == 'popular'} ? 'active'" 
                                          th:href="@{/news?sort=popular}">Most Popular</a></li>
                                    <li><a class="dropdown-item" th:classappend="${sort == 'trending'} ? 'active'" 
                                          th:href="@{/news?sort=trending}">Trending</a></li>
                                </ul>
                            </div>
                        </div>

                        <!-- News List -->
                        <div class="news-list">
                            <div class="news-item mb-4 pb-4 border-bottom" th:each="news : ${newsList.content}">
                                <div class="row g-4">
                                    <div class="col-md-4">
                                        <a th:href="@{/news/{id}(id=${news.id})}" class="d-block">
                                            <img th:src="${news.imageUrl}" 
                                                 class="img-fluid rounded" 
                                                 th:alt="${news.title}">
                                        </a>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="category-badge mb-2">
                                            <a th:href="@{/category/{slug}(slug=${news.category.slug})}" 
                                               class="badge" 
                                               th:style="'background-color: ' + ${news.category.color} + ';'"
                                               th:text="${news.category.name}">
                                                Category
                                            </a>
                                        </div>
                                        <h3 class="h5 mb-2">
                                            <a th:href="@{/news/{id}(id=${news.id})}" 
                                               class="text-decoration-none"
                                               th:text="${news.title}">
                                                News Title
                                            </a>
                                        </h3>
                                        <p class="text-muted small mb-2" th:text="${#strings.abbreviate(news.summary, 200)}">
                                            News summary goes here...
                                        </p>
                                        <div class="news-meta d-flex flex-wrap align-items-center">
                                            <div class="author me-3">
                                                <i class="far fa-user me-1"></i>
                                                <span th:text="${news.author?.name ?: 'Staff Reporter'}">Author</span>
                                            </div>
                                            <div class="date me-3" 
                                                 th:title="${#temporals.format(news.publishedAt, 'EEEE, MMMM d, yyyy h:mm a')}">
                                                <i class="far fa-clock me-1"></i>
                                                <span th:text="${#temporals.format(news.publishedAt, 'MMM d, yyyy')}">Date</span>
                                            </div>
                                            <div class="views me-3">
                                                <i class="far fa-eye me-1"></i>
                                                <span th:text="${#numbers.formatInteger(news.viewCount, 1, 'POINT')}">0</span> views
                                            </div>
                                            <div class="comments ms-auto">
                                                <i class="far fa-comment me-1"></i>
                                                <span th:text="${#numbers.formatInteger(news.commentCount, 1, 'POINT')}">0</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pagination -->
                        <nav aria-label="Page navigation" th:if="${newsList.totalPages > 1}">
                            <ul class="pagination justify-content-center">
                                <li class="page-item" th:classappend="${newsList.first} ? 'disabled'">
                                    <a class="page-link" 
                                       th:href="@{${'?page=' + (newsList.number - 1) + (sort ? '&sort=' + sort : '')}}" 
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                    </a>
                                </li>
                                
                                <li th:each="i : ${#numbers.sequence(1, newsList.totalPages)}" 
                                    class="page-item" 
                                    th:classappend="${i == newsList.number + 1} ? 'active'">
                                    <a class="page-link" 
                                       th:href="@{'?page=' + (i - 1) + (sort ? '&sort=' + sort : '')}" 
                                       th:text="${i}">1</a>
                                </li>
                                
                                <li class="page-item" th:classappend="${newsList.last} ? 'disabled'">
                                    <a class="page-link" 
                                       th:href="@{${'?page=' + (newsList.number + 1) + (sort ? '&sort=' + sort : '')}}" 
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="col-lg-4">
                    <!-- Search Widget -->
                    <div class="card mb-4 border-0 shadow-sm">
                        <div class="card-body">
                            <h3 class="h5 mb-3">Search</h3>
                            <form th:action="@{/search}" method="get" class="search-form">
                                <div class="input-group">
                                    <input type="text" 
                                           name="q" 
                                           class="form-control" 
                                           placeholder="Search news..."
                                           th:value="${searchQuery ?: ''}">
                                    <button class="btn btn-primary" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Categories Widget -->
                    <div class="card mb-4 border-0 shadow-sm">
                        <div class="card-header bg-white border-0 py-3">
                            <h3 class="h5 mb-0">Categories</h3>
                        </div>
                        <div class="list-group list-group-flush">
                            <a th:each="category : ${categories}" 
                               th:href="@{/category/{slug}(slug=${category.slug})}" 
                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center border-0">
                                <span th:text="${category.name}">Category Name</span>
                                <span class="badge rounded-pill" 
                                      th:style="'background-color: ' + ${category.color} + ';'"
                                      th:text="${category.newsCount}">0</span>
                            </a>
                        </div>
                    </div>

                    <!-- Popular Tags -->
                    <div class="card mb-4 border-0 shadow-sm">
                        <div class="card-header bg-white border-0 py-3">
                            <h3 class="h5 mb-0">Popular Tags</h3>
                        </div>
                        <div class="card-body">
                            <div class="d-flex flex-wrap gap-2">
                                <a th:each="tag : ${popularTags}" 
                                   th:href="@{/tag/{slug}(slug=${tag.slug})}" 
                                   class="btn btn-sm btn-outline-secondary"
                                   th:text="'#' + ${tag.name}">
                                    #tag
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Newsletter -->
                    <div class="card mb-4 border-0 shadow-sm">
                        <div class="card-body text-center">
                            <div class="mb-3">
                                <i class="fas fa-envelope-open-text fa-3x text-primary"></i>
                            </div>
                            <h4>Newsletter</h4>
                            <p class="text-muted small">Subscribe to get the latest news and updates.</p>
                            <form class="mt-3">
                                <div class="input-group mb-2">
                                    <input type="email" class="form-control form-control-sm" placeholder="Your email">
                                    <button class="btn btn-primary btn-sm" type="submit">Subscribe</button>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="privacyPolicy" required>
                                    <label class="form-check-label small" for="privacyPolicy">
                                        I agree to the <a href="/privacy" class="text-decoration-none">Privacy Policy</a>
                                    </label>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Trending Now -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white border-0 py-3">
                            <h3 class="h5 mb-0">Trending Now</h3>
                        </div>
                        <div class="list-group list-group-flush">
                            <a th:each="news : ${trendingNews}" 
                               th:href="@{/news/{id}(id=${news.id})}" 
                               class="list-group-item list-group-item-action border-0 py-3">
                                <div class="d-flex">
                                    <div class="flex-shrink-0 me-3">
                                        <img th:src="${news.imageUrl}" 
                                             class="rounded" 
                                             width="80" 
                                             th:alt="${news.title}">
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1" th:text="${news.title}">Trending news title</h6>
                                        <small class="text-muted" 
                                               th:text="${#temporals.format(news.publishedAt, 'MMM d')}">Date</small>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
